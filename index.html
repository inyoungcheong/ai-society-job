<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI & Society Global Job Board</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap');

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            min-height: 100vh;
            color: #111827;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin: 3rem auto 3rem auto;
            padding-top: 2rem;
            color: #111827;
            max-width: 800px;
        }

        .logo-symbol {
            font-size: 2rem;
            color: #06b6d4;
            margin-bottom: 1rem;
            letter-spacing: 0.5rem;
        }

        .header h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.8rem;
            margin-bottom: 1rem;
            font-weight: 600;
            color: #111827;
            letter-spacing: -0.02em;
        }

        .header p {
            font-size: 1.1rem;
            color: #6b7280;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.7;
        }

        /* Update other elements to match the new color scheme */
        .stats-compact {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(6, 182, 212, 0.08);
            margin-bottom: 2rem;
            text-align: center;
            border: 1px solid rgba(6, 182, 212, 0.1);
        }

        .stats-inline {
            font-size: 1.1rem;
            color: #111827;
            font-weight: 500;
        }

        .stats-inline .stat-number {
            font-weight: 700;
            color: #06b6d4;
        }

        .filters {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(6, 182, 212, 0.08);
            margin-bottom: 2rem;
            border: 1px solid rgba(6, 182, 212, 0.1);
        }

        .filters h3 {
            margin-bottom: 1rem;
            color: #111827;
            font-weight: 600;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #374151;
        }

        select, input {
            padding: 0.75rem;
            border: 2px solid #d1d5db;
            border-radius: 12px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: white;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #06b6d4;
            box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.1);
        }

        .search-btn {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.25);
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(6, 182, 212, 0.3);
            background: linear-gradient(135deg, #0891b2, #0e7490);
        }

        .jobs-container {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(6, 182, 212, 0.08);
            overflow: hidden;
            border: 1px solid rgba(6, 182, 212, 0.1);
        }

        .jobs-header {
            background: #f8fafc;
            padding: 1.5rem;
            border-bottom: 1px solid rgba(6, 182, 212, 0.1);
        }

        .jobs-header h3 {
            margin-bottom: 1rem;
            color: #111827;
            font-weight: 600;
        }

        .sort-options {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .sort-btn {
            padding: 0.5rem 1rem;
            border: 2px solid #d1d5db;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .sort-btn.active {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
            color: white;
            border-color: #0891b2;
            box-shadow: 0 2px 8px rgba(6, 182, 212, 0.25);
        }

        .sort-btn:hover:not(.active) {
            border-color: #06b6d4;
            background: #f1f5f9;
            color: #0e7490;
        }

        .job-list {
            max-height: 600px;
            overflow-y: auto;
        }

        .job-item {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .job-item:hover {
            background: #fefce8;
            border-left: 4px solid #06b6d4;
            padding-left: calc(1.5rem - 4px);
        }

        .job-item:last-child {
            border-bottom: none;
        }

        .job-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
        }

        .job-info {
            flex: 1;
        }

        .job-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #111827;
            margin-bottom: 0.5rem;
            line-height: 1.3;
        }

        .job-title a {
            color: #111827;
            text-decoration: none;
            transition: color 0.2s ease;
            cursor: pointer;
        }

        .job-title a:hover {
            color: #06b6d4;
            text-decoration: underline;
        }



        .job-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.9rem;
            color: #6b7280;
            margin-bottom: 0.75rem;
            flex-wrap: wrap;
        }

        .job-tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .tag {
            background: #f1f5f9;
            color: #06b6d4;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            border: 1px solid rgba(6, 182, 212, 0.2);
        }

        .tag.faculty { background: #f0f9ff; color: #0369a1; border-color: rgba(3, 105, 161, 0.2); }
        .tag.industry { background: #fff7ed; color: #ea580c; border-color: rgba(234, 88, 12, 0.2); }
        .tag.nonprofit { background: #fdf2f8; color: #be185d; border-color: rgba(190, 24, 93, 0.2); }
        .tag.government { background: #eff6ff; color: #2563eb; border-color: rgba(37, 99, 235, 0.2); }
        .tag.international { background: #f5f3ff; color: #7c3aed; border-color: rgba(124, 58, 237, 0.2); }

        .tag.law { background: #fef7ff; color: #a21caf; border-color: rgba(162, 28, 175, 0.2); }
        .tag.policy { background: #f0f9ff; color: #0369a1; border-color: rgba(3, 105, 161, 0.2); }
        .tag.technical { background: #fff1f2; color: #dc2626; border-color: rgba(220, 38, 38, 0.2); }
        .tag.research { background: #f0fdf4; color: #16a34a; border-color: rgba(22, 163, 74, 0.2); }

        .relevance-score {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-weight: 700;
            font-size: 0.9rem;
            min-width: 60px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(6, 182, 212, 0.25);
        }

        .loading, .no-results {
            text-align: center;
            padding: 3rem;
            color: #6b7280;
        }

        .last-update {
            text-align: center;
            margin-top: 2rem;
            color: #6b7280;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .filter-row {
                grid-template-columns: 1fr;
            }
            
            .job-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .job-meta {
                flex-direction: column;
                gap: 0.25rem;
            }

            .stats-inline {
                font-size: 1rem;
                line-height: 1.8;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-symbol">✦ ✧ ✦</div>
            <h1>AI & Society Global Job Board</h1>
            <p>Faculty, Industry, Non-profit, Government & International positions in AI ethics, policy, law, and societal impacts</p>
        </div>

        <!-- Compact Stats Section -->
        <div class="stats-compact">
            <div class="stats-inline" id="stats-display">
                📊 <span class="stat-number">--</span> Total Jobs • 
                <span class="stat-number">--</span> Faculty • 
                <span class="stat-number">--</span> Industry • 
                <span class="stat-number">--</span> Government • 
                <span class="stat-number">--</span> International
            </div>
        </div>

        <div class="filters">
            <h3>🔍 Filter Jobs</h3>
            <div class="filter-row">
                <div class="filter-group">
                    <label for="job-type">Job Type</label>
                    <select id="job-type">
                        <option value="all">All Types</option>
                        <option value="faculty">Faculty</option>
                        <option value="industry">Industry</option>
                        <option value="nonprofit">Non-profit</option>
                        <option value="government">Government</option>
                        <option value="international">International</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="category">Category</label>
                    <select id="category">
                        <option value="all">All Categories</option>
                        <option value="law">Law</option>
                        <option value="policy">Policy</option>
                        <option value="technical">Technical</option>
                        <option value="research">Research</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="location">Location</label>
                    <input type="text" id="location" placeholder="e.g., Remote, California">
                </div>
                <div class="filter-group">
                    <label for="keyword">Keywords</label>
                    <input type="text" id="keyword" placeholder="e.g., machine learning, ethics">
                </div>
                <div class="filter-group">
                    <button class="search-btn" onclick="applyFilters()">Search</button>
                </div>
            </div>
        </div>

        <div class="jobs-container">
            <div class="jobs-header">
                <h3>📋 Job Listings</h3>
                <div class="sort-options">
                    <button class="sort-btn active" onclick="sortJobs('relevance')">Relevance</button>
                    <button class="sort-btn" onclick="sortJobs('date')">Date</button>
                    <button class="sort-btn" onclick="sortJobs('company')">Company</button>
                </div>
            </div>
            
            <div class="job-list" id="job-list">
                <div class="loading">
                    <p>🔄 Loading jobs...</p>
                </div>
            </div>
        </div>

        <div class="last-update">
            Last updated: <span id="last-update">--</span>
        </div>
    </div>

    <script>
        let allJobs = [];
        let filteredJobs = [];
        let currentSort = 'relevance';

        // Load jobs data
        async function loadJobs() {
            try {
                const files = ['data/jsearch_jobs.json', 'data/ajo_gemini_jobs.json'];
                const allData = await Promise.all(files.map(f => fetch(f).then(res => res.json())));
        
                const combinedJobs = [];
                const combinedStats = {
                    total: 0,
                    by_job_type: {
                        faculty: 0,
                        industry: 0,
                        nonprofit: 0,
                        government: 0,
                        international: 0
                    }
                };
        
                allData.forEach((data, index) => {
                    const sourceLabel = files[index].includes('ajo') ? 'AJO' : 'JSearch';
        
                    (data.jobs || []).forEach(job => {
                        job.source_origin = sourceLabel; // 🔖 추적용
                        combinedJobs.push(job);
                    });
        
                    const stats = data.stats || {};
                    combinedStats.total += stats.total || 0;
        
                    const jobTypes = stats.by_job_type || {};
                    for (const key in combinedStats.by_job_type) {
                        combinedStats.by_job_type[key] += jobTypes[key] || 0;
                    }
                });
        
                allJobs = combinedJobs;
                filteredJobs = [...allJobs];
        
                updateStats(combinedStats);
        
                // 최근 업데이트 날짜 중 가장 최신 것 사용
                const timestamps = allData.map(d => new Date(d.metadata?.last_update || 0));
                const latest = new Date(Math.max(...timestamps));
                updateLastUpdate(latest.toISOString());
        
                renderJobs();
            } catch (error) {
                console.error('Error loading jobs:', error);
                loadDemoData();
            }
        }


        // Demo data fallback
        function loadDemoData() {
            allJobs = [
                {
                    title: "AI Ethics Researcher",
                    company: "Stanford HAI",
                    location: "Stanford, CA, US",
                    job_type: "faculty",
                    category: "research",
                    description: "Research position focusing on AI ethics and societal impact...",
                    posting_date: "2025-07-20",
                    deadline: "2025-09-15",
                    source_url: "https://example.com/job1",
                    relevance_score: 95,
                    tags: ["AI Ethics", "Research", "Faculty"]
                },
                {
                    title: "AI Policy Analyst",
                    company: "Google",
                    location: "Mountain View, CA, US",
                    job_type: "industry",
                    category: "policy",
                    description: "Analyze AI policy implications for technology development...",
                    posting_date: "2025-07-19",
                    deadline: null,
                    source_url: "https://example.com/job2",
                    relevance_score: 88,
                    tags: ["Policy", "Analysis", "Industry"]
                },
                {
                    title: "AI Governance Specialist",
                    company: "OECD",
                    location: "Paris, France",
                    job_type: "international",
                    category: "policy",
                    description: "Develop international standards and guidelines for AI governance...",
                    posting_date: "2025-07-18",
                    deadline: "2025-09-05",
                    source_url: "https://example.com/job4",
                    relevance_score: 96,
                    tags: ["International", "AI Governance", "Policy"]
                },
                {
                    title: "Digital Rights Legal Counsel",
                    company: "Federal Trade Commission",
                    location: "Washington, DC, US",
                    job_type: "government",
                    category: "law",
                    description: "Legal counsel specializing in digital rights and AI regulation...",
                    posting_date: "2025-07-17",
                    deadline: "2025-08-25",
                    source_url: "https://example.com/job5",
                    relevance_score: 94,
                    tags: ["Legal", "Digital Rights", "Government"]
                }
            ];

            updateStats({
                total: 15,
                by_job_type: { faculty: 4, industry: 5, government: 2, international: 1, nonprofit: 3 }
            });
            
            updateLastUpdate("2025-07-25T12:00:00Z");
            filteredJobs = [...allJobs];
            renderJobs();
        }

        // Update statistics display
        function updateStats(stats) {
            const jobTypes = stats.by_job_type || {};
            const total = stats.total || 0;
            const faculty = jobTypes.faculty || 0;
            const industry = jobTypes.industry || 0;
            const government = jobTypes.government || 0;
            const international = jobTypes.international || 0;

            document.getElementById('stats-display').innerHTML = `
                📊 <span class="stat-number">${total}</span> Total Jobs • 
                <span class="stat-number">${faculty}</span> Faculty • 
                <span class="stat-number">${industry}</span> Industry • 
                <span class="stat-number">${government}</span> Government • 
                <span class="stat-number">${international}</span> International
            `;
        }

        // Update last update timestamp
        function updateLastUpdate(timestamp) {
            const date = new Date(timestamp);
            document.getElementById('last-update').textContent = date.toLocaleString('en-US');
        }

        // Render job listings
        function renderJobs() {
            const jobList = document.getElementById('job-list');
            
            if (filteredJobs.length === 0) {
                jobList.innerHTML = '<div class="no-results">No jobs match your search criteria.</div>';
                return;
            }

            const jobsHTML = filteredJobs.map(job => `
                <div class="job-item">
                    <div class="job-header">
                        <div class="job-info">
                            <div class="job-title">
                                <a href="${job.source_url}" target="_blank" rel="noopener noreferrer">
                                    ${job.title}
                                </a>
                            </div>
                            <div class="job-company">${job.company}</div>
                            <div class="job-meta">
                                <span>🌍 ${job.location || 'Location TBD'}</span>
                                <span>📅 ${new Date(job.posting_date).toLocaleDateString('en-US')}</span>
                                ${job.deadline ? `<span>⏰ Deadline: ${new Date(job.deadline).toLocaleDateString('en-US')}</span>` : ''}
                                ${job.salary_info ? `<span>💰 ${job.salary_info}</span>` : ''}
                            </div>
                            <div class="job-tags">
                                <span class="tag ${job.job_type}">${job.job_type}</span>
                                <span class="tag ${job.category}">${job.category}</span>
                                <span class="tag">${job.source_origin}</span>
                                ${job.tags ? job.tags.slice(0, 3).map(tag => `<span class="tag">${tag}</span>`).join('') : ''}
                                ${job.is_remote ? '<span class="tag">Remote</span>' : ''}
                            </div>
                        </div>
                        <div class="relevance-score">${job.relevance_score}%</div>
                    </div>
                </div>
            `).join('');

            jobList.innerHTML = jobsHTML;
        }

        // Apply filters
        function applyFilters() {
            const jobType = document.getElementById('job-type').value;
            const category = document.getElementById('category').value;
            const location = document.getElementById('location').value.toLowerCase();
            const keyword = document.getElementById('keyword').value.toLowerCase();

            filteredJobs = allJobs.filter(job => {
                return (jobType === 'all' || job.job_type === jobType) &&
                       (category === 'all' || job.category === category) &&
                       (location === '' || job.location.toLowerCase().includes(location)) &&
                       (keyword === '' || 
                        job.title.toLowerCase().includes(keyword) ||
                        job.description.toLowerCase().includes(keyword) ||
                        job.company.toLowerCase().includes(keyword));
            });

            sortJobs(currentSort);
        }

        // Sort jobs
        function sortJobs(type) {
            currentSort = type;
            
            // Update active sort button
            document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            switch(type) {
                case 'relevance':
                    filteredJobs.sort((a, b) => b.relevance_score - a.relevance_score);
                    break;
                case 'date':
                    filteredJobs.sort((a, b) => new Date(b.posting_date) - new Date(a.posting_date));
                    break;
                case 'company':
                    filteredJobs.sort((a, b) => a.company.localeCompare(b.company));
                    break;
            }

            renderJobs();
        }

        // Initialize on page load
        window.addEventListener('load', loadJobs);
    </script>
</body>
</html>
